<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0,
                 maximum-scale=1.0, user-scalable=no" />
  <title>Ejercicios Interactivos con Tema Espacial</title>
  <style>
    /* ==================== Modo Oscuro con Fondo Espacial, Enfoque M√≥vil ===================== */
    * {
      margin: 0; 
      padding: 0; 
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      background: #1d1d1d 
        url("data:image/svg+xml,\
             %3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400' viewBox='0 0 400 400'%3E%3Cg fill='%23ffffff' fill-opacity='0.3'%3E%3Crect width='1' height='1' x='10' y='10'/%3E%3Crect width='1' height='1' x='200' y='300'/%3E%3Crect width='1' height='1' x='123' y='220'/%3E%3Crect width='1' height='1' x='350' y='180'/%3E%3Crect width='1' height='1' x='50' y='150'/%3E%3Crect width='1' height='1' x='320' y='80'/%3E%3Crect width='1' height='1' x='70' y='360'/%3E%3Crect width='1' height='1' x='105' y='105'/%3E%3Crect width='1' height='1' x='280' y='200'/%3E%3C/g%3E%3C/svg%3E") 
        repeat;
      color: #fff;
      margin: auto;
      max-width: 480px; /* Para pantallas grandes, centrado. */
      padding: 10px;
      min-height: 100vh;
      position: relative;
    }

    h1, h2 {
      text-align: center;
      margin: 20px 0 10px;
    }
    h1 {
      font-size: 1.4rem;
    }
    h2 {
      font-size: 1.2rem;
    }
    h3 {
      margin: 10px 0;
      font-size: 1rem;
    }

    /* Cada ‚Äúpantalla‚Äù (secci√≥n) ocupa la vista principal */
    .pantalla {
      display: none; /* Se muestra solo la activa */
      min-height: 80vh;
      background: rgba(255,255,255,0.05); /* Fondo oscuro semitransparente */
      margin: 10px 0;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
      position: relative;
    }

    /* Botones de navegaci√≥n y revisi√≥n */
    .boton {
      display: inline-block;
      background: #2b2b2b;
      color: #fff;
      border: 1px solid #444;
      padding: 10px 20px;
      border-radius: 6px;
      text-decoration: none;
      margin: 20px 5px 0;
      text-align: center;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .boton:hover {
      background: #444;
    }

    /* Retroalimentaci√≥n */
    .retro {
      margin-top: 8px;
      font-weight: bold;
    }
    .error {
      color: #ff6961;
    }
    .correcto {
      color: #77dd77;
    }

    /* Opciones (M√∫ltiple, V/F) */
    .opciones {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin: 10px 0;
    }
    .opcion {
      background: #333;
      padding: 10px;
      border-radius: 4px;
      cursor: pointer;
      text-align: center;
      border: 1px solid #555;
      transition: background 0.2s;
    }
    .opcion:active,
    .opcion:hover {
      background: #444;
    }

    /* T√≠tulo con emoji */
    .titulo-emoji {
      font-size: 1.5rem;
      display: inline-block;
      margin-right: 6px;
    }

    /* Arrastrar y Soltar (Pointer Events) */
    .zona-drag-drop {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 10px 0;
    }
    .item-drag {
      background: #333;
      border: 1px dashed #666;
      border-radius: 5px;
      padding: 10px;
      min-width: 100px;
      text-align: center;
      cursor: grab;
      touch-action: none; /* Importante para pointer en mobile */
      position: relative; /* Para reposicionar con pointer events */
    }
    .zona-drop {
      background: #2f2f2f;
      border: 2px dashed #777;
      border-radius: 5px;
      min-height: 50px;
      min-width: 120px;
      padding: 10px;
      text-align: center;
      position: relative;
    }

    /* √ìrbita de la Luna */
    .orbita-contenedor {
      position: relative;
      width: 250px;
      height: 250px;
      margin: 20px auto;
      background: #222;
      border-radius: 50%;
      box-shadow: inset 0 0 30px rgba(0,0,0,0.3);
    }
    .tierra {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.2rem;
    }
    .luna {
      position: absolute;
      width: 40px; 
      height: 40px;
      font-size: 2rem;
      cursor: pointer;
      user-select: none;
      transform: translate(-50%, -50%);
      top: 50%; 
      left: 90%;
      touch-action: none; /* pointer events para mobile */
    }

    /* Reordenar Planetas */
    .contenedor-planetas {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }
    .planeta, .espacio-planeta {
      background: #333;
      border: 1px solid #555;
      border-radius: 4px;
      padding: 8px;
      text-align: center;
      width: 80%;
      max-width: 300px;
      margin: 0 auto;
      cursor: grab;
      touch-action: none; /* pointer events en mobile */
      position: relative;
    }
    .espacio-planeta {
      border: 1px dashed #666;
      min-height: 40px;
    }
  </style>
</head>

<body>
  <h1><span class="titulo-emoji">üöÄ</span>Ejercicios Interactivos con Tema Espacial</h1>

  <!-- ====== PANTALLA 1: OPCI√ìN M√öLTIPLE (SISTEMA SOLAR) ====== -->
  <section class="pantalla" id="pantalla1">
    <h2>1) Opci√≥n M√∫ltiple: Sistema Solar</h2>

    <!-- Pregunta 1 -->
    <h3>¬øDe d√≥nde proviene la luz de la Luna? üåô</h3>
    <div class="opciones" data-respuesta="Del Sol">
      <div class="opcion">De la Tierra</div>
      <div class="opcion">De Marte</div>
      <div class="opcion">Del Sol</div>
      <div class="opcion">De J√∫piter</div>
    </div>
    <div class="retro"></div>

    <!-- Pregunta 2 -->
    <h3>¬øCu√°l es la estrella m√°s grande de nuestro sistema solar? üåü</h3>
    <div class="opciones" data-respuesta="El Sol">
      <div class="opcion">La Luna</div>
      <div class="opcion">Saturno</div>
      <div class="opcion">El Sol</div>
      <div class="opcion">Urano</div>
    </div>
    <div class="retro"></div>

    <!-- Pregunta 3 -->
    <h3>¬øCu√°ntos planetas giran alrededor del Sol? ü™ê</h3>
    <div class="opciones" data-respuesta="8">
      <div class="opcion">7</div>
      <div class="opcion">8</div>
      <div class="opcion">9</div>
      <div class="opcion">10</div>
    </div>
    <div class="retro"></div>

    <button class="boton" onclick="cambiarPantalla(2)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 2: √ìRBITA INTERACTIVA DE LA LUNA ====== -->
  <section class="pantalla" id="pantalla2">
    <h2>2) √ìrbita Interactiva de la Luna</h2>
    <p>Arrastra la Luna alrededor de la Tierra para ver las fases:</p>

    <div class="orbita-contenedor" id="orbitaContenedor">
      <div class="tierra">üåç</div>
      <div class="luna" id="lunaEl">üåï</div>
    </div>
    <div class="retro" id="retroLuna"></div>

    <button class="boton" onclick="cambiarPantalla(1)">‚¨ÖÔ∏è Atr√°s</button>
    <button class="boton" onclick="cambiarPantalla(3)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 3: RELACIONAR ESTACIONES (DRAG & DROP) ====== -->
  <section class="pantalla" id="pantalla3">
    <h2>3) Relacionar: Estaciones del A√±o</h2>
    <p>Arrastra cada estaci√≥n hacia su descripci√≥n correcta:</p>

    <div class="zona-drag-drop" id="estacionesItems">
      <div class="item-drag" data-match="Primavera">Primavera üåº</div>
      <div class="item-drag" data-match="Verano">Verano ‚òÄÔ∏è</div>
      <div class="item-drag" data-match="Oto√±o">Oto√±o üçÇ</div>
      <div class="item-drag" data-match="Invierno">Invierno ‚ùÑÔ∏è</div>
    </div>
    <div class="zona-drag-drop" id="estacionesDrop">
      <div class="zona-drop" data-expect="Primavera">[Flores y √°rboles verdes]</div>
      <div class="zona-drop" data-expect="Verano">[Ni√±os en la playa]</div>
      <div class="zona-drop" data-expect="Oto√±o">[Hojas secas]</div>
      <div class="zona-drop" data-expect="Invierno">[Nieve y fr√≠o]</div>
    </div>
    <div class="retro" id="retroEstaciones"></div>

    <button class="boton" onclick="revisarRelacion('estacionesDrop','retroEstaciones')">Revisar</button>
    <button class="boton" onclick="cambiarPantalla(2)">‚¨ÖÔ∏è Atr√°s</button>
    <button class="boton" onclick="cambiarPantalla(4)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 4: RELACIONAR FASES DE LA LUNA ====== -->
  <section class="pantalla" id="pantalla4">
    <h2>4) Relacionar: Fases de la Luna</h2>
    <p>Arrastra el nombre de la fase a su respectivo emoji:</p>

    <div class="zona-drag-drop">
      <div class="item-drag" data-match="Luna Nueva">Luna Nueva</div>
      <div class="item-drag" data-match="Cuarto Creciente">Cuarto Creciente</div>
      <div class="item-drag" data-match="Luna Llena">Luna Llena</div>
      <div class="item-drag" data-match="Cuarto Menguante">Cuarto Menguante</div>
    </div>
    <div class="zona-drag-drop" id="fasesDrop">
      <div class="zona-drop" data-expect="Luna Nueva">üåë</div>
      <div class="zona-drop" data-expect="Cuarto Creciente">üåì</div>
      <div class="zona-drop" data-expect="Luna Llena">üåï</div>
      <div class="zona-drop" data-expect="Cuarto Menguante">üåó</div>
    </div>
    <div class="retro" id="retroFasesLuna"></div>

    <button class="boton" onclick="revisarRelacion('fasesDrop','retroFasesLuna')">Revisar</button>
    <button class="boton" onclick="cambiarPantalla(3)">‚¨ÖÔ∏è Atr√°s</button>
    <button class="boton" onclick="cambiarPantalla(5)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 5: OPCI√ìN M√öLTIPLE (FECHAS IMPORTANTES) ====== -->
  <section class="pantalla" id="pantalla5">
    <h2>5) Fechas Importantes</h2>

    <h3>¬øCu√°ndo empieza la primavera? üå∏</h3>
    <div class="opciones" data-respuesta="20 de marzo">
      <div class="opcion">20 de junio</div>
      <div class="opcion">20 de marzo</div>
      <div class="opcion">23 de septiembre</div>
      <div class="opcion">21 de diciembre</div>
    </div>
    <div class="retro"></div>

    <h3>¬øCu√°ndo empieza el oto√±o? üçÅ</h3>
    <div class="opciones" data-respuesta="23 de septiembre">
      <div class="opcion">21 de junio</div>
      <div class="opcion">20 de marzo</div>
      <div class="opcion">23 de septiembre</div>
      <div class="opcion">22 de diciembre</div>
    </div>
    <div class="retro"></div>

    <button class="boton" onclick="cambiarPantalla(4)">‚¨ÖÔ∏è Atr√°s</button>
    <button class="boton" onclick="cambiarPantalla(6)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 6: VERDADERO/FALSO ====== -->
  <section class="pantalla" id="pantalla6">
    <h2>6) Verdadero o Falso</h2>

    <h3>La Tierra tarda 365 d√≠as en dar una vuelta al Sol. üåç</h3>
    <div class="opciones" data-respuesta="Verdadero">
      <div class="opcion">Verdadero</div>
      <div class="opcion">Falso</div>
    </div>
    <div class="retro"></div>

    <h3>El Sol gira alrededor de la Tierra. ‚òÄÔ∏è</h3>
    <div class="opciones" data-respuesta="Falso">
      <div class="opcion">Falso</div>
      <div class="opcion">Verdadero</div>
    </div>
    <div class="retro"></div>

    <button class="boton" onclick="cambiarPantalla(5)">‚¨ÖÔ∏è Atr√°s</button>
    <button class="boton" onclick="cambiarPantalla(7)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 7: REORDENAR PLANETAS ====== -->
  <section class="pantalla" id="pantalla7">
    <h2>7) Ordenar los Planetas</h2>
    <p>Arrastra cada planeta a su espacio correspondiente (empezando por el m√°s cercano al Sol):</p>

    <div class="contenedor-planetas">
      <div class="planeta" data-orden="1">Mercurio</div>
      <div class="planeta" data-orden="2">Venus</div>
      <div class="planeta" data-orden="3">Tierra</div>
      <div class="planeta" data-orden="4">Marte</div>
      <div class="planeta" data-orden="5">J√∫piter</div>
      <div class="planeta" data-orden="6">Saturno</div>
      <div class="planeta" data-orden="7">Urano</div>
      <div class="planeta" data-orden="8">Neptuno</div>
    </div>
    <br>
    <div class="contenedor-planetas" id="slotsPlanetas">
      <div class="espacio-planeta" data-esperado="1">Espacio 1</div>
      <div class="espacio-planeta" data-esperado="2">Espacio 2</div>
      <div class="espacio-planeta" data-esperado="3">Espacio 3</div>
      <div class="espacio-planeta" data-esperado="4">Espacio 4</div>
      <div class="espacio-planeta" data-esperado="5">Espacio 5</div>
      <div class="espacio-planeta" data-esperado="6">Espacio 6</div>
      <div class="espacio-planeta" data-esperado="7">Espacio 7</div>
      <div class="espacio-planeta" data-esperado="8">Espacio 8</div>
    </div>
    <div class="retro" id="retroPlanetas"></div>

    <button class="boton" onclick="revisarPlanetas()">Revisar</button>
    <button class="boton" onclick="cambiarPantalla(6)">‚¨ÖÔ∏è Atr√°s</button>
    <button class="boton" onclick="cambiarPantalla(8)">Siguiente ‚û°Ô∏è</button>
  </section>

  <!-- ====== PANTALLA 8: OPCI√ìN M√öLTIPLE (D√çAS DE LOS MESES) ====== -->
  <section class="pantalla" id="pantalla8">
    <h2>8) D√≠as de los Meses</h2>

    <h3>¬øCu√°ntos d√≠as tiene febrero en un a√±o normal? ‚ùì</h3>
    <div class="opciones" data-respuesta="28">
      <div class="opcion">27</div>
      <div class="opcion">28</div>
      <div class="opcion">29</div>
      <div class="opcion">30</div>
    </div>
    <div class="retro"></div>

    <h3>¬øCu√°ntos d√≠as tiene diciembre? ‚ùÑÔ∏è</h3>
    <div class="opciones" data-respuesta="31">
      <div class="opcion">28</div>
      <div class="opcion">29</div>
      <div class="opcion">30</div>
      <div class="opcion">31</div>
    </div>
    <div class="retro"></div>

    <button class="boton" onclick="cambiarPantalla(7)">‚¨ÖÔ∏è Atr√°s</button>
    <!-- Aqu√≠ podr√≠a terminar o iniciar de nuevo -->
  </section>

  <script>
  /**************************************************************
   * FUNCIONES DE NAVEGACI√ìN DE PANTALLAS
   **************************************************************/
  let pantallaActual = 1;
  function cambiarPantalla(num) {
    document.querySelectorAll('.pantalla').forEach(p => p.style.display = 'none');
    pantallaActual = num;
    const sel = document.getElementById('pantalla' + num);
    if(sel) sel.style.display = 'block';
  }
  // Al iniciar, mostramos la pantalla 1
  cambiarPantalla(pantallaActual);

  /**************************************************************
   * 1) Opci√≥n M√∫ltiple & Verdadero/Falso (mismo c√≥digo de validaci√≥n)
   **************************************************************/
  document.querySelectorAll('.opciones').forEach(grupo => {
    const respCorrecta = grupo.dataset.respuesta;
    const retro = grupo.parentElement.querySelector('.retro');
    grupo.querySelectorAll('.opcion').forEach(op => {
      op.addEventListener('click', () => {
        if(op.textContent.trim() === respCorrecta) {
          retro.textContent = "¬°Correcto! ‚úÖ";
          retro.classList.add('correcto');
          retro.classList.remove('error');
        } else {
          retro.textContent = "Intenta de nuevo. ‚ùå";
          retro.classList.add('error');
          retro.classList.remove('correcto');
        }
      });
    });
  });

  /**************************************************************
   * 2) √ìrbita Interactiva de la Luna (Pointer Events)
   **************************************************************/
  const luna = document.getElementById('lunaEl');
  const orbita = document.getElementById('orbitaContenedor');
  const retroLuna = document.getElementById('retroLuna');

  let arrastrandoLuna = false;
  let offsetX = 0, offsetY = 0;

  function obtenerCentro() {
    const rect = orbita.getBoundingClientRect();
    return {
      cx: rect.left + rect.width/2,
      cy: rect.top + rect.height/2,
      radio: rect.width / 2.3
    };
  }

  function iniciarArrastreLuna(e) {
    e.preventDefault();
    arrastrandoLuna = true;
    if(e.type === 'touchstart') {
      offsetX = e.touches[0].clientX - luna.getBoundingClientRect().left;
      offsetY = e.touches[0].clientY - luna.getBoundingClientRect().top;
    } else {
      offsetX = e.clientX - luna.getBoundingClientRect().left;
      offsetY = e.clientY - luna.getBoundingClientRect().top;
    }
    document.addEventListener('pointermove', moverLuna);
    document.addEventListener('pointerup', soltarLuna);
    document.addEventListener('touchmove', moverLuna, {passive:false});
    document.addEventListener('touchend', soltarLuna);
  }

  function moverLuna(e) {
    if(!arrastrandoLuna) return;
    let clientX, clientY;
    if(e.type === 'touchmove') {
      clientX = e.touches[0].clientX;
      clientY = e.touches[0].clientY;
    } else {
      clientX = e.clientX;
      clientY = e.clientY;
    }

    const {cx, cy, radio} = obtenerCentro();
    const dx = clientX - cx - offsetX;
    const dy = clientY - cy - offsetY;
    const angulo = Math.atan2(dy, dx);

    const nuevoX = cx + radio * Math.cos(angulo);
    const nuevoY = cy + radio * Math.sin(angulo);

    const rectOrbita = orbita.getBoundingClientRect();
    luna.style.left = (nuevoX - rectOrbita.left) + "px";
    luna.style.top = (nuevoY - rectOrbita.top) + "px";

    actualizarFaseLunar(angulo);
  }

  function soltarLuna() {
    arrastrandoLuna = false;
    document.removeEventListener('pointermove', moverLuna);
    document.removeEventListener('touchmove', moverLuna);
  }

  function actualizarFaseLunar(rads) {
    let deg = rads * (180/Math.PI);
    if(deg < 0) deg += 360;

    let fase = "", emoji = "";
    if(deg >= 0 && deg < 90) {
      fase = "Cuarto Creciente";
      emoji = "üåì";
    } else if(deg >= 90 && deg < 180) {
      fase = "Luna Llena";
      emoji = "üåï";
    } else if(deg >= 180 && deg < 270) {
      fase = "Cuarto Menguante";
      emoji = "üåó";
    } else {
      fase = "Luna Nueva";
      emoji = "üåë";
    }
    luna.textContent = emoji;
    retroLuna.textContent = `Fase actual: ${fase}`;
  }

  luna.addEventListener('pointerdown', iniciarArrastreLuna);
  luna.addEventListener('touchstart', iniciarArrastreLuna, {passive:false});

  /**************************************************************
   * 3 & 4) Relacionar Columnas con Pointer Events
   **************************************************************/
  let itemArrastrado = null;
  let deltaX = 0, deltaY = 0;

  // Habilitamos pointer events en cada .item-drag
  document.querySelectorAll('.item-drag').forEach(item => {
    item.addEventListener('pointerdown', e => {
      e.preventDefault();
      itemArrastrado = item;
      deltaX = e.clientX - item.getBoundingClientRect().left;
      deltaY = e.clientY - item.getBoundingClientRect().top;
      item.setPointerCapture(e.pointerId);
      item.addEventListener('pointermove', moverItem);
      item.addEventListener('pointerup', soltarItem);
    });
  });

  function moverItem(e) {
    if(!itemArrastrado) return;
    let x = e.clientX - deltaX;
    let y = e.clientY - deltaY;
    itemArrastrado.style.position = 'absolute';
    itemArrastrado.style.zIndex = '999';
    itemArrastrado.style.left = x + 'px';
    itemArrastrado.style.top = y + 'px';
  }

  function soltarItem(e) {
    if(!itemArrastrado) return;
    itemArrastrado.removeEventListener('pointermove', moverItem);
    itemArrastrado.removeEventListener('pointerup', soltarItem);

    // Revisar si suelta sobre una zona-drop
    let zona = document.elementFromPoint(e.clientX, e.clientY);
    if(zona && zona.classList.contains('zona-drop')) {
      // Solo si est√° vac√≠a
      if(zona.children.length === 0) {
        resetPosicion(itemArrastrado);
        zona.appendChild(itemArrastrado);
      } else {
        resetPosicion(itemArrastrado);
      }
    } else {
      resetPosicion(itemArrastrado);
    }
    itemArrastrado = null;
  }

  function resetPosicion(item) {
    item.style.position = 'relative';
    item.style.left = '0px';
    item.style.top = '0px';
    item.style.zIndex = '1';
    // Retorna a su contenedor original si no se deposit√≥ en zona-drop
    const parentId = item.getAttribute('data-origen');
    if(parentId && !item.parentElement.classList.contains('zona-drop')) {
      const originalParent = document.getElementById(parentId);
      if(originalParent) originalParent.appendChild(item);
    }
  }

  // Asignamos data-origen para cada item
  document.querySelectorAll('.zona-drag-drop').forEach(zona => {
    zona.querySelectorAll('.item-drag').forEach(item => {
      item.setAttribute('data-origen', zona.id);
    });
  });

  /* Funci√≥n para ‚ÄúRevisar‚Äù en Estaciones o Fases */
  function revisarRelacion(zonaDropId, retroId) {
    const contenedorZonas = document.getElementById(zonaDropId);
    const drops = contenedorZonas.querySelectorAll('.zona-drop');
    let correctos = 0;
    drops.forEach(drop => {
      const esperado = drop.dataset.expect;
      const item = drop.querySelector('.item-drag');
      if(item && item.dataset.match === esperado) {
        correctos++;
      }
    });
    const retro = document.getElementById(retroId);
    if(correctos === drops.length) {
      retro.textContent = "¬°Perfecto! Todas las coincidencias son correctas. ‚úÖ";
      retro.classList.remove('error');
      retro.classList.add('correcto');
    } else {
      retro.textContent = "Algunas relaciones no coinciden. ‚ùå";
      retro.classList.add('error');
      retro.classList.remove('correcto');
    }
  }

  /**************************************************************
   * 7) Reordenar Planetas (Pointer-based)
   **************************************************************/
  let planetaArr = null;
  let pxOffX = 0, pxOffY = 0;

  document.querySelectorAll('.planeta').forEach(planet => {
    planet.addEventListener('pointerdown', e => {
      e.preventDefault();
      planetaArr = planet;
      pxOffX = e.clientX - planet.getBoundingClientRect().left;
      pxOffY = e.clientY - planet.getBoundingClientRect().top;
      planet.setPointerCapture(e.pointerId);
      planet.addEventListener('pointermove', moverPlaneta);
      planet.addEventListener('pointerup', soltarPlaneta);
    });
  });

  function moverPlaneta(e) {
    if(!planetaArr) return;
    let x = e.clientX - pxOffX;
    let y = e.clientY - pxOffY;
    planetaArr.style.zIndex = '999';
    planetaArr.style.position = 'absolute';
    planetaArr.style.left = x + 'px';
    planetaArr.style.top = y + 'px';
  }

  function soltarPlaneta(e) {
    if(!planetaArr) return;
    planetaArr.removeEventListener('pointermove', moverPlaneta);
    planetaArr.removeEventListener('pointerup', soltarPlaneta);

    let target = document.elementFromPoint(e.clientX, e.clientY);
    if(target && target.classList.contains('espacio-planeta')) {
      // Si est√° vac√≠o
      if(target.children.length === 0) {
        resetPlanetaPos(planetaArr);
        target.appendChild(planetaArr);
      } else {
        resetPlanetaPos(planetaArr);
      }
    } else {
      resetPlanetaPos(planetaArr);
    }
    planetaArr = null;
  }

  function resetPlanetaPos(planet) {
    planet.style.position = 'relative';
    planet.style.left = '0px';
    planet.style.top = '0px';
    planet.style.zIndex = '1';
    // Si no est√° en un espacio-planeta, retornamos a la lista
    const cont = document.querySelector('.contenedor-planetas');
    if(cont && !planet.parentElement.classList.contains('espacio-planeta')) {
      cont.appendChild(planet);
    }
  }

  function revisarPlanetas() {
    const slots = document.querySelectorAll('.espacio-planeta');
    let bien = 0;
    slots.forEach(slot => {
      const esperado = slot.dataset.esperado;
      const p = slot.querySelector('.planeta');
      if(p && p.dataset.orden === esperado) {
        bien++;
      }
    });
    const retro = document.getElementById('retroPlanetas');
    if(bien === slots.length) {
      retro.textContent = "¬°Todos los planetas est√°n en el orden correcto! ‚úÖ";
      retro.classList.remove('error');
      retro.classList.add('correcto');
    } else {
      retro.textContent = "Algunos planetas est√°n fuera de lugar. ‚ùå";
      retro.classList.add('error');
      retro.classList.remove('correcto');
    }
  }
  </script>
</body>
</html>
