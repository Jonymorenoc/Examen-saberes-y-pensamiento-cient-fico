<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0,
                 maximum-scale=1.0, user-scalable=no" />
  <title>Ejercicios Interactivos con Tema Espacial</title>
  <style>
    /*****************************************************
     * 1) RESET Y BASE: BLOQUEAR SCROLL Y EVITAR SELECCI√ìN
     *****************************************************/
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden; /* Bloquea el scroll */
      height: 100%;
    }
    * {
      box-sizing: border-box;
      user-select: none; /* Evita selecci√≥n de texto */
      -webkit-user-select: none;
      -ms-user-select: none;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #fff;
      position: relative;
    }

    /*****************************************************
     * 2) CONTENEDOR DE ESTRELLAS CON ANIMACI√ìN
     *****************************************************/
    #starfield {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      pointer-events: none; /* Para no interferir con clics/arrastres */
      z-index: 0;
    }
    .star {
      position: absolute;
      width: 3px;
      height: 3px;
      border-radius: 50%;
      background: radial-gradient(white, transparent 70%);
      opacity: 0;
      animation: twinkle var(--duration) infinite;
    }
    @keyframes twinkle {
      0%   { opacity: 0;   }
      50%  { opacity: 0.8; }
      100% { opacity: 0;   }
    }

    /*****************************************************
     * 3) CONTENEDOR GENERAL DE PANTALLAS
     *****************************************************/
    .pantalla {
      position: relative;
      z-index: 1; /* Para estar por encima de las estrellas */
      display: none;
      width: 100%;
      max-width: 480px;
      min-height: 100vh;
      margin: 0 auto;
      padding: 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.4);

      /* Centrado flex */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    /*****************************************************
     * 4) ESTILOS DE TITULOS Y TEXTOS
     *****************************************************/
    h1, h2, h3 {
      margin-bottom: 15px;
    }
    h1 {
      font-size: 1.8rem;
    }
    h2 {
      font-size: 1.5rem;
    }
    h3 {
      font-size: 1.2rem;
    }
    p {
      margin: 10px 0;
      line-height: 1.4;
    }

    /*****************************************************
     * 5) BOTONES DE NAVEGACI√ìN (ATR√ÅS / SIGUIENTE)
     *****************************************************/
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 400px;
      margin-top: 20px;
    }
    .boton {
      background: #2b2b2b;
      color: #fff;
      border: none;
      padding: 12px 25px;
      border-radius: 6px;
      text-decoration: none;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s;
      min-width: 100px;
    }
    .boton:hover {
      background: #444;
    }

    /*****************************************************
     * 6) RETROALIMENTACI√ìN
     *****************************************************/
    .retro {
      margin-top: 10px;
      font-weight: bold;
    }
    .error {
      color: #ff6961;
    }
    .correcto {
      color: #77dd77;
    }

    /*****************************************************
     * 7) OPCIONES DE M√öLTIPLE ELECCI√ìN
     *****************************************************/
    .opciones {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin: 15px 0;
      width: 100%;
      max-width: 300px;
    }
    .opcion {
      background: #333;
      padding: 12px;
      border-radius: 4px;
      cursor: pointer;
      border: 1px solid #555;
      transition: background 0.2s;
      text-align: center;
      touch-action: none; /* Para evitar gestos no deseados en m√≥vil */
    }
    .opcion:hover,
    .opcion:active {
      background: #444;
    }

    /*****************************************************
     * 8) DRAG & DROP: ITEMS Y ZONAS
     *****************************************************/
    .zona-drag-drop {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
      width: 100%;
      max-width: 400px;
    }

    /* Estructura ‚Äútexto + emoji‚Äù grande */
    .item-drag {
      background: #333;
      border: 1px dashed #666;
      border-radius: 5px;
      padding: 10px;
      text-align: center;
      cursor: grab;
      position: relative;
      touch-action: none; /* Drag en m√≥vil */
      width: 120px; /* Ajusta a tu gusto */
    }
    .drag-text {
      font-size: 1rem;
      margin-bottom: 5px;
    }
    .drag-emoji {
      font-size: 2rem; /* Emoji grande */
      line-height: 1;
    }

    .zona-drop {
      background: #2f2f2f;
      border: 2px dashed #777;
      border-radius: 5px;
      min-height: 80px;
      min-width: 120px;
      padding: 10px;
      text-align: center;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 5px;
    }
    .drop-text {
      font-size: 1rem;
    }
    .drop-emoji {
      font-size: 2rem;
    }

    /*****************************************************
     * 9) √ìRBITA INTERACTIVA DE LA LUNA
     *****************************************************/
    .orbita-contenedor {
      position: relative;
      width: 250px;
      height: 250px;
      margin: 20px auto;
      background: #222;
      border-radius: 50%;
      box-shadow: inset 0 0 30px rgba(0,0,0,0.3);
    }
    .tierra {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.2rem;
    }
    .luna {
      position: absolute;
      width: 40px;
      height: 40px;
      font-size: 2rem;
      cursor: pointer;
      transform: translate(-50%, -50%);
      top: 50%;
      left: 90%;
      touch-action: none; /* Para arrastrar en m√≥vil */
    }

    /*****************************************************
     * 10) REORDENAR PLANETAS
     *****************************************************/
    .contenedor-planetas {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      margin: 15px 0;
      width: 100%;
      max-width: 300px;
    }
    .planeta, .espacio-planeta {
      background: #333;
      border: 1px solid #555;
      border-radius: 4px;
      padding: 10px;
      text-align: center;
      width: 100%;
      cursor: grab;
      position: relative;
      touch-action: none; /* Drag en m√≥vil */
    }
    .espacio-planeta {
      border: 1px dashed #666;
      min-height: 40px;
    }
  </style>
</head>

<body>
  <!-- Contenedor para estrellas animadas -->
  <div id="starfield"></div>

  <!-- PANTALLA 1: BIENVENIDA -->
  <section class="pantalla" id="pantalla1">
    <h1>üöÄ Bienvenido a los Ejercicios Espaciales</h1>
    <p>Explora el sistema solar, arrastra la Luna, relaciona estaciones y fases, y m√°s.</p>
    <div class="nav-buttons">
      <!-- Solo un bot√≥n ‚ÄúSiguiente‚Äù para iniciar -->
      <span></span> <!-- Espacio a la izquierda -->
      <button class="boton" onclick="cambiarPantalla(2)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 2: PREGUNTA M√öLTIPLE -->
  <section class="pantalla" id="pantalla2">
    <h2>Pregunta 1</h2>
    <h3>¬øDe d√≥nde proviene la luz de la Luna? üåô</h3>
    <div class="opciones" data-respuesta="Del Sol">
      <div class="opcion">De la Tierra</div>
      <div class="opcion">De Marte</div>
      <div class="opcion">Del Sol</div>
      <div class="opcion">De J√∫piter</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(1)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(3)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 3: PREGUNTA M√öLTIPLE -->
  <section class="pantalla" id="pantalla3">
    <h2>Pregunta 2</h2>
    <h3>¬øCu√°l es la estrella m√°s grande de nuestro sistema solar? üåü</h3>
    <div class="opciones" data-respuesta="El Sol">
      <div class="opcion">La Luna</div>
      <div class="opcion">Saturno</div>
      <div class="opcion">El Sol</div>
      <div class="opcion">Urano</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(2)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(4)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 4: PREGUNTA M√öLTIPLE -->
  <section class="pantalla" id="pantalla4">
    <h2>Pregunta 3</h2>
    <h3>¬øCu√°ntos planetas giran alrededor del Sol? ü™ê</h3>
    <div class="opciones" data-respuesta="8">
      <div class="opcion">7</div>
      <div class="opcion">8</div>
      <div class="opcion">9</div>
      <div class="opcion">10</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(3)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(5)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 5: RELACIONAR ESTACIONES (DRAG & DROP) -->
  <section class="pantalla" id="pantalla5">
    <h2>Relaci√≥n de Estaciones</h2>
    <p>Arrastra cada estaci√≥n hacia su descripci√≥n correcta:</p>
    <div class="zona-drag-drop" id="estacionesItems">
      <div class="item-drag" data-match="Primavera">
        <div class="drag-text">Primavera</div>
        <div class="drag-emoji">üåº</div>
      </div>
      <div class="item-drag" data-match="Verano">
        <div class="drag-text">Verano</div>
        <div class="drag-emoji">‚òÄÔ∏è</div>
      </div>
      <div class="item-drag" data-match="Oto√±o">
        <div class="drag-text">Oto√±o</div>
        <div class="drag-emoji">üçÇ</div>
      </div>
      <div class="item-drag" data-match="Invierno">
        <div class="drag-text">Invierno</div>
        <div class="drag-emoji">‚ùÑÔ∏è</div>
      </div>
    </div>
    <div class="zona-drag-drop" id="estacionesDrop">
      <div class="zona-drop" data-expect="Primavera">[Flores y √°rboles verdes]</div>
      <div class="zona-drop" data-expect="Verano">[Ni√±os en la playa]</div>
      <div class="zona-drop" data-expect="Oto√±o">[Hojas secas]</div>
      <div class="zona-drop" data-expect="Invierno">[Nieve y fr√≠o]</div>
    </div>
    <div class="retro" id="retroEstaciones"></div>
    <button class="boton" onclick="revisarRelacion('estacionesDrop','retroEstaciones')">Revisar</button>

    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(4)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(6)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 6: DEMOSTRACI√ìN INTERACTIVA DE LA LUNA -->
  <section class="pantalla" id="pantalla6">
    <h2>Demostraci√≥n: √ìrbita de la Luna</h2>
    <p>Arrastra la Luna alrededor de la Tierra para ver las fases:</p>
    <div class="orbita-contenedor" id="orbitaContenedor">
      <div class="tierra">üåç</div>
      <div class="luna" id="lunaEl">üåï</div>
    </div>
    <div class="retro" id="retroLuna"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(5)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(7)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 7: RELACI√ìN FASES DE LA LUNA (DRAG & DROP) -->
  <section class="pantalla" id="pantalla7">
    <h2>Relaci√≥n: Fases de la Luna</h2>
    <p>Arrastra el nombre de la fase al emoji correspondiente:</p>

    <!-- √çtems con texto y emoji grande -->
    <div class="zona-drag-drop">
      <div class="item-drag" data-match="Luna Nueva">
        <div class="drag-text">Luna Nueva</div>
        <div class="drag-emoji">üåë</div>
      </div>
      <div class="item-drag" data-match="Cuarto Creciente">
        <div class="drag-text">Cuarto Creciente</div>
        <div class="drag-emoji">üåì</div>
      </div>
      <div class="item-drag" data-match="Luna Llena">
        <div class="drag-text">Luna Llena</div>
        <div class="drag-emoji">üåï</div>
      </div>
      <div class="item-drag" data-match="Cuarto Menguante">
        <div class="drag-text">Cuarto Menguante</div>
        <div class="drag-emoji">üåó</div>
      </div>
    </div>

    <!-- Zonas de destino (solo texto de ejemplo) -->
    <div class="zona-drag-drop" id="fasesDrop">
      <div class="zona-drop" data-expect="Luna Nueva">
        <div class="drop-text">Fase</div>
        <div class="drop-emoji">üåë</div>
      </div>
      <div class="zona-drop" data-expect="Cuarto Creciente">
        <div class="drop-text">Fase</div>
        <div class="drop-emoji">üåì</div>
      </div>
      <div class="zona-drop" data-expect="Luna Llena">
        <div class="drop-text">Fase</div>
        <div class="drop-emoji">üåï</div>
      </div>
      <div class="zona-drop" data-expect="Cuarto Menguante">
        <div class="drop-text">Fase</div>
        <div class="drop-emoji">üåó</div>
      </div>
    </div>

    <div class="retro" id="retroFasesLuna"></div>
    <button class="boton" onclick="revisarRelacion('fasesDrop','retroFasesLuna')">Revisar</button>

    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(6)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(8)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 8: M√öLTIPLE ELECCI√ìN -->
  <section class="pantalla" id="pantalla8">
    <h2>Pregunta 4</h2>
    <h3>¬øCu√°ndo empieza la primavera? üå∏</h3>
    <div class="opciones" data-respuesta="20 de marzo">
      <div class="opcion">20 de junio</div>
      <div class="opcion">20 de marzo</div>
      <div class="opcion">23 de septiembre</div>
      <div class="opcion">21 de diciembre</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(7)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(9)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 9: M√öLTIPLE ELECCI√ìN -->
  <section class="pantalla" id="pantalla9">
    <h2>Pregunta 5</h2>
    <h3>¬øCu√°ndo empieza el oto√±o? üçÅ</h3>
    <div class="opciones" data-respuesta="23 de septiembre">
      <div class="opcion">21 de junio</div>
      <div class="opcion">20 de marzo</div>
      <div class="opcion">23 de septiembre</div>
      <div class="opcion">22 de diciembre</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(8)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(10)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 10: VERDADERO/FALSO -->
  <section class="pantalla" id="pantalla10">
    <h2>Pregunta 6</h2>
    <h3>La Tierra tarda 365 d√≠as en dar una vuelta al Sol. üåç</h3>
    <div class="opciones" data-respuesta="Verdadero">
      <div class="opcion">Verdadero</div>
      <div class="opcion">Falso</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(9)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(11)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 11: VERDADERO/FALSO -->
  <section class="pantalla" id="pantalla11">
    <h2>Pregunta 7</h2>
    <h3>El Sol gira alrededor de la Tierra. ‚òÄÔ∏è</h3>
    <div class="opciones" data-respuesta="Falso">
      <div class="opcion">Falso</div>
      <div class="opcion">Verdadero</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(10)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(12)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 12: REORDENAR PLANETAS -->
  <section class="pantalla" id="pantalla12">
    <h2>Ordena los Planetas</h2>
    <p>Arrastra cada planeta a su espacio correspondiente (de m√°s cercano al Sol):</p>
    <div class="contenedor-planetas" id="planetasLista">
      <div class="planeta" data-orden="1">Mercurio</div>
      <div class="planeta" data-orden="2">Venus</div>
      <div class="planeta" data-orden="3">Tierra</div>
      <div class="planeta" data-orden="4">Marte</div>
      <div class="planeta" data-orden="5">J√∫piter</div>
      <div class="planeta" data-orden="6">Saturno</div>
      <div class="planeta" data-orden="7">Urano</div>
      <div class="planeta" data-orden="8">Neptuno</div>
    </div>
    <div class="contenedor-planetas" id="slotsPlanetas">
      <div class="espacio-planeta" data-esperado="1">Espacio 1</div>
      <div class="espacio-planeta" data-esperado="2">Espacio 2</div>
      <div class="espacio-planeta" data-esperado="3">Espacio 3</div>
      <div class="espacio-planeta" data-esperado="4">Espacio 4</div>
      <div class="espacio-planeta" data-esperado="5">Espacio 5</div>
      <div class="espacio-planeta" data-esperado="6">Espacio 6</div>
      <div class="espacio-planeta" data-esperado="7">Espacio 7</div>
      <div class="espacio-planeta" data-esperado="8">Espacio 8</div>
    </div>
    <div class="retro" id="retroPlanetas"></div>
    <button class="boton" onclick="revisarPlanetas()">Revisar</button>

    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(11)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(13)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 13: M√öLTIPLE ELECCI√ìN -->
  <section class="pantalla" id="pantalla13">
    <h2>Pregunta 8</h2>
    <h3>¬øCu√°ntos d√≠as tiene febrero en un a√±o normal? ‚ùì</h3>
    <div class="opciones" data-respuesta="28">
      <div class="opcion">27</div>
      <div class="opcion">28</div>
      <div class="opcion">29</div>
      <div class="opcion">30</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(12)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(14)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 14: M√öLTIPLE ELECCI√ìN -->
  <section class="pantalla" id="pantalla14">
    <h2>Pregunta 9</h2>
    <h3>¬øCu√°ntos d√≠as tiene diciembre? ‚ùÑÔ∏è</h3>
    <div class="opciones" data-respuesta="31">
      <div class="opcion">28</div>
      <div class="opcion">29</div>
      <div class="opcion">30</div>
      <div class="opcion">31</div>
    </div>
    <div class="retro"></div>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(13)">‚¨ÖÔ∏è Atr√°s</button>
      <button class="boton" onclick="cambiarPantalla(15)">Siguiente ‚û°Ô∏è</button>
    </div>
  </section>

  <!-- PANTALLA 15: EJEMPLO EXTRA (ELASTICIDAD) -->
  <section class="pantalla" id="pantalla15">
    <h2>Propiedad de la Elasticidad</h2>
    <p>
      El otro d√≠a mi mam√° me dio una pluma y, por curiosidad, la abr√≠. Vi que ten√≠a un peque√±o resorte.
      Al estirarlo, volvi√≥ a su forma original. Me llam√≥ mucho la atenci√≥n.
    </p>
    <p><strong>La elasticidad</strong> es la propiedad que tienen algunos objetos de estirarse y volver a su mismo estado.</p>
    <h3>¬øQu√© objetos conocen que tengan la propiedad de ser el√°sticos?</h3>
    <p>
      Reflexiona y contesta las siguientes preguntas:
      <br>‚Ä¢ ¬øUna liga tiene la propiedad de la elasticidad?
      <br>‚Ä¢ ¬øUn chicle, cuando se estira, tiene propiedad de elasticidad?
    </p>
    <p>
      Dibuja en tu cuaderno un objeto que tenga esta propiedad.
      Estira una liga y observa con mucho cuidado: ¬øqu√© pas√≥?
    </p>
    <p>
      Observa las siguientes im√°genes y contesta si tienen la propiedad de la elasticidad o no.
      (Ejemplos: resortes, slinky, espirales...)
    </p>
    <p>El dinam√≥metro es un objeto que ayuda a medir la fuerza que ejerce un objeto.</p>
    <div class="nav-buttons">
      <button class="boton" onclick="cambiarPantalla(14)">‚¨ÖÔ∏è Atr√°s</button>
      <span></span> <!-- Espacio a la derecha -->
    </div>
  </section>

  <script>
    /*****************************************************
     * A) GENERAR ESTRELLAS ALEATORIAS EN EL FONDO
     *****************************************************/
    const starContainer = document.getElementById('starfield');
    const starCount = 50; // N√∫mero de estrellas
    for (let i = 0; i < starCount; i++) {
      const star = document.createElement('div');
      star.classList.add('star');

      // Posici√≥n aleatoria
      star.style.top = Math.random() * 100 + 'vh';
      star.style.left = Math.random() * 100 + 'vw';

      // Duraci√≥n de parpadeo y retraso aleatorio
      const duration = (2 + Math.random() * 2).toFixed(2); // entre 2s y 4s
      const delay = (Math.random() * 5).toFixed(2);        // entre 0s y 5s
      star.style.setProperty('--duration', duration + 's');
      star.style.animationDelay = delay + 's';

      starContainer.appendChild(star);
    }

    /*****************************************************
     * B) CAMBIO DE PANTALLAS
     *****************************************************/
    let pantallaActual = 1;
    function cambiarPantalla(num) {
      document.querySelectorAll('.pantalla').forEach(p => p.style.display = 'none');
      pantallaActual = num;
      const sel = document.getElementById('pantalla' + num);
      if (sel) sel.style.display = 'flex';
    }
    // Mostrar la pantalla inicial
    cambiarPantalla(pantallaActual);

    /*****************************************************
     * C) VALIDACI√ìN DE OPCIONES (M√öLTIPLE ELECCI√ìN)
     *****************************************************/
    document.querySelectorAll('.opciones').forEach(grupo => {
      const respCorrecta = grupo.dataset.respuesta;
      const retro = grupo.parentElement.querySelector('.retro');
      grupo.querySelectorAll('.opcion').forEach(op => {
        op.addEventListener('click', () => {
          if (op.textContent.trim() === respCorrecta) {
            retro.textContent = "¬°Correcto! ‚úÖ";
            retro.classList.add('correcto');
            retro.classList.remove('error');
          } else {
            retro.textContent = "Intenta de nuevo. ‚ùå";
            retro.classList.add('error');
            retro.classList.remove('correcto');
          }
        });
      });
    });

    /*****************************************************
     * D) √ìRBITA INTERACTIVA DE LA LUNA
     *****************************************************/
    const luna = document.getElementById('lunaEl');
    const orbita = document.getElementById('orbitaContenedor');
    const retroLuna = document.getElementById('retroLuna');

    let arrastrandoLuna = false;
    let offsetX = 0, offsetY = 0;

    function obtenerCentro() {
      const rect = orbita.getBoundingClientRect();
      return {
        cx: rect.left + rect.width / 2,
        cy: rect.top + rect.height / 2,
        radio: rect.width / 2.3
      };
    }

    function iniciarArrastreLuna(e) {
      e.preventDefault();
      arrastrandoLuna = true;
      if (e.type === 'touchstart') {
        offsetX = e.touches[0].clientX - luna.getBoundingClientRect().left;
        offsetY = e.touches[0].clientY - luna.getBoundingClientRect().top;
      } else {
        offsetX = e.clientX - luna.getBoundingClientRect().left;
        offsetY = e.clientY - luna.getBoundingClientRect().top;
      }
      document.addEventListener('pointermove', moverLuna);
      document.addEventListener('pointerup', soltarLuna);
      document.addEventListener('touchmove', moverLuna, { passive: false });
      document.addEventListener('touchend', soltarLuna);
    }

    function moverLuna(e) {
      if (!arrastrandoLuna) return;
      let clientX, clientY;
      if (e.type === 'touchmove') {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
      } else {
        clientX = e.clientX;
        clientY = e.clientY;
      }
      const { cx, cy, radio } = obtenerCentro();
      const dx = clientX - cx - offsetX;
      const dy = clientY - cy - offsetY;
      const angulo = Math.atan2(dy, dx);
      const nuevoX = cx + radio * Math.cos(angulo);
      const nuevoY = cy + radio * Math.sin(angulo);
      const rectOrbita = orbita.getBoundingClientRect();
      luna.style.left = (nuevoX - rectOrbita.left) + "px";
      luna.style.top = (nuevoY - rectOrbita.top) + "px";
      actualizarFaseLunar(angulo);
    }

    function soltarLuna() {
      arrastrandoLuna = false;
      document.removeEventListener('pointermove', moverLuna);
      document.removeEventListener('touchmove', moverLuna);
    }

    function actualizarFaseLunar(rads) {
      let deg = rads * (180 / Math.PI);
      if (deg < 0) deg += 360;
      let fase = "", emoji = "";
      if (deg >= 0 && deg < 90) {
        fase = "Cuarto Creciente";
        emoji = "üåì";
      } else if (deg >= 90 && deg < 180) {
        fase = "Luna Llena";
        emoji = "üåï";
      } else if (deg >= 180 && deg < 270) {
        fase = "Cuarto Menguante";
        emoji = "üåó";
      } else {
        fase = "Luna Nueva";
        emoji = "üåë";
      }
      luna.textContent = emoji;
      retroLuna.textContent = `Fase actual: ${fase}`;
    }

    luna.addEventListener('pointerdown', iniciarArrastreLuna);
    luna.addEventListener('touchstart', iniciarArrastreLuna, { passive: false });

    /*****************************************************
     * E) DRAG & DROP PARA EJERCICIOS (ESTACIONES, FASES)
     *****************************************************/
    let itemArrastrado = null, deltaX = 0, deltaY = 0;
    document.querySelectorAll('.item-drag').forEach(item => {
      item.addEventListener('pointerdown', e => {
        e.preventDefault();
        itemArrastrado = item;
        deltaX = e.clientX - item.getBoundingClientRect().left;
        deltaY = e.clientY - item.getBoundingClientRect().top;
        item.setPointerCapture(e.pointerId);
        item.addEventListener('pointermove', moverItem);
        item.addEventListener('pointerup', soltarItem);
      });
    });

    function moverItem(e) {
      if (!itemArrastrado) return;
      let x = e.clientX - deltaX;
      let y = e.clientY - deltaY;
      itemArrastrado.style.position = 'absolute';
      itemArrastrado.style.zIndex = '999';
      itemArrastrado.style.left = x + 'px';
      itemArrastrado.style.top = y + 'px';
    }

    function soltarItem(e) {
      if (!itemArrastrado) return;
      itemArrastrado.removeEventListener('pointermove', moverItem);
      itemArrastrado.removeEventListener('pointerup', soltarItem);
      // Verificamos si se suelta sobre una zona-drop
      let zona = document.elementFromPoint(e.clientX, e.clientY);
      if (zona && zona.classList.contains('zona-drop')) {
        if (zona.children.length === 0 || // Est√° vac√≠o
            [...zona.children].every(ch => !ch.classList?.contains('item-drag'))) {
          resetPosicion(itemArrastrado);
          zona.appendChild(itemArrastrado);
        } else {
          resetPosicion(itemArrastrado);
        }
      } else {
        resetPosicion(itemArrastrado);
      }
      itemArrastrado = null;
    }

    function resetPosicion(item) {
      item.style.position = 'relative';
      item.style.left = '0px';
      item.style.top = '0px';
      item.style.zIndex = '1';
      // Si no est√° en zona-drop, vuelve a su contenedor original
      const parentId = item.getAttribute('data-origen');
      if (parentId && !item.parentElement.classList.contains('zona-drop')) {
        const originalParent = document.getElementById(parentId);
        if (originalParent) originalParent.appendChild(item);
      }
    }

    // Asignamos data-origen a cada item-drag
    document.querySelectorAll('.zona-drag-drop').forEach(zona => {
      zona.querySelectorAll('.item-drag').forEach(item => {
        item.setAttribute('data-origen', zona.id);
      });
    });

    // Funci√≥n para revisar (Estaciones, Fases)
    function revisarRelacion(zonaDropId, retroId) {
      const contenedorZonas = document.getElementById(zonaDropId);
      const drops = contenedorZonas.querySelectorAll('.zona-drop');
      let correctos = 0;
      drops.forEach(drop => {
        const esperado = drop.dataset.expect;
        const item = drop.querySelector('.item-drag');
        if (item && item.dataset.match === esperado) {
          correctos++;
        }
      });
      const retro = document.getElementById(retroId);
      if (correctos === drops.length) {
        retro.textContent = "¬°Perfecto! ‚úÖ";
        retro.classList.remove('error');
        retro.classList.add('correcto');
      } else {
        retro.textContent = "Algunas relaciones no coinciden. ‚ùå";
        retro.classList.add('error');
        retro.classList.remove('correcto');
      }
    }

    /*****************************************************
     * F) REORDENAR PLANETAS
     *****************************************************/
    let planetaArr = null, pxOffX = 0, pxOffY = 0;
    document.querySelectorAll('.planeta').forEach(planet => {
      planet.addEventListener('pointerdown', e => {
        e.preventDefault();
        planetaArr = planet;
        pxOffX = e.clientX - planet.getBoundingClientRect().left;
        pxOffY = e.clientY - planet.getBoundingClientRect().top;
        planet.setPointerCapture(e.pointerId);
        planet.addEventListener('pointermove', moverPlaneta);
        planet.addEventListener('pointerup', soltarPlaneta);
      });
    });

    function moverPlaneta(e) {
      if (!planetaArr) return;
      let x = e.clientX - pxOffX;
      let y = e.clientY - pxOffY;
      planetaArr.style.zIndex = '999';
      planetaArr.style.position = 'absolute';
      planetaArr.style.left = x + 'px';
      planetaArr.style.top = y + 'px';
    }

    function soltarPlaneta(e) {
      if (!planetaArr) return;
      planetaArr.removeEventListener('pointermove', moverPlaneta);
      planetaArr.removeEventListener('pointerup', soltarPlaneta);
      let target = document.elementFromPoint(e.clientX, e.clientY);
      if (target && target.classList.contains('espacio-planeta')) {
        if (target.children.length === 0) {
          resetPlanetaPos(planetaArr);
          target.appendChild(planetaArr);
        } else {
          resetPlanetaPos(planetaArr);
        }
      } else {
        resetPlanetaPos(planetaArr);
      }
      planetaArr = null;
    }

    function resetPlanetaPos(planet) {
      planet.style.position = 'relative';
      planet.style.left = '0px';
      planet.style.top = '0px';
      planet.style.zIndex = '1';
      const cont = document.querySelector('#planetasLista');
      if (cont && !planet.parentElement.classList.contains('espacio-planeta')) {
        cont.appendChild(planet);
      }
    }

    function revisarPlanetas() {
      const slots = document.querySelectorAll('.espacio-planeta');
      let bien = 0;
      slots.forEach(slot => {
        const esperado = slot.dataset.esperado;
        const p = slot.querySelector('.planeta');
        if (p && p.dataset.orden === esperado) {
          bien++;
        }
      });
      const retro = document.getElementById('retroPlanetas');
      if (bien === slots.length) {
        retro.textContent = "¬°Correcto! Todos los planetas est√°n ordenados. ‚úÖ";
        retro.classList.remove('error');
        retro.classList.add('correcto');
      } else {
        retro.textContent = "Algunos planetas est√°n fuera de lugar. ‚ùå";
        retro.classList.add('error');
        retro.classList.remove('correcto');
      }
    }
  </script>
</body>
</html>
